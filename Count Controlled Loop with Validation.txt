;Write an LC-3 assembly program that will retrieve 10 digits from the keyboard.

.orig x3000
	LD R2, ZERO

	LEA R0, PROMPT
	PUTS

	LD R1, COUNT	; initialize counter R1
AGAIN 	BRz DONE
	; loop body
	LD R0, 	NEWLINE
	OUT
	LD R0, 	LEFTSQBR
	OUT
	ADD R0, R2, #0
	OUT
	LD R0, 	RIGHTSQBR
	OUT
	LD R0, 	COLON
	OUT

	GETC
	OUT
	
	JSR VALIDATE
	ADD R5, R5, #0	; set CC based on R5
	BRp NO_GOOD

	ADD R2, R2, #1
	ADD R1, R1 #-1
	BRnzp AGAIN

NO_GOOD 
	LD R0, 	NEWLINE
	OUT
	LEA R0, ERROR
	PUTS
	ADD R1, R1, #0
	BRnzp AGAIN

DONE HALT

ERROR .stringz "Invalid input. Not a digit. Try again..."
PROMPT .stringz "Enter 10 digits... "
NEWLINE .fill x000A
COUNT .fill #10
ZERO .fill x0030
LEFTSQBR .fill x005B
RIGHTSQBR .fill x005D
COLON .fill x003A




; Pre-condition: R0 has an ASCII character
; Post-condition: R5 = 0 if R0 contains a digit
	;	R5 = 1 if R0 contains a non-digit
VALIDATE	
	ST R7, VSAVER7
	ST R1, VSAVER1
	
	AND R5, R5, #0	; R5 = 0

	LD R1, NEG0
	ADD R1, R0, R1
	BRn BAD
	LD R1, NEG9
	ADD R1, R0, R1
	BRp BAD
	BRnzp GOOD

BAD	ADD R5, R5, #1
GOOD	LD R7, VSAVER7
	LD R1, VSAVER1
	RET

NEG0 .fill #-48
NEG9 .fill #-57
VSAVER7 .blkw #1
VSAVER1 .blkw #1


.end















